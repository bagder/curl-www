not verifying certs for TLS to IP address / Secure Transport
============================================================

Project curl Security Advisory, March 26th 2014
[Permalink](https://curl.se/docs/CVE-2014-1263.html)

VULNERABILITY
-------------

When asked to do a TLS connection (HTTPS, FTPS, IMAPS, etc) to a URL specified
with an IP address instead of a name, libcurl would wrongly not verify the
server's name in the certificate. The signature (whether it was signed by a
trusted CA) and validity (whether the date was within the certificate's
lifetime and it was not revoked) verification was still performed.

This is a problem in libcurl built to use the Secure Transport backend. Secure
Transport is the TLS library present and used on Mac OS X and iOS.

Only users on Mac OS X or iOS can be affected by this. And only if libcurl
was built to use the native TLS backend library.

This problem was initially used as an example of the Apple SSL bug that hit
[the news in late February
2014](https://www.imperialviolet.org/2014/02/22/applebug.html) but that was
not correct.

INFO
----

The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2014-1263 to this issue.

CWE-297: Improper Validation of Certificate with Host Mismatch

AFFECTED VERSIONS
-----------------

This flaw has existed ever since libcurl started to support the Secure
Transport backend.

- Affected versions: from libcurl 7.27.0 to and including 7.35.0
- Not affected versions: libcurl < 7.27.0 and >= 7.36.0
- Introduced-in: https://github.com/curl/curl/commit/6d1ea388cbd9de7f2a944a0

libcurl is used by many applications, but not always advertised as such!

SOLUTION
------------

libcurl 7.36.0 makes sure that all TLS using requests verify the host name
even if specified as an IP address in the URL.

- Fixed-in: https://github.com/curl/curl/commit/afc6e5004fabee

RECOMMENDATIONS
---------------

We suggest you take one of the following actions immediately, in order of
preference:

 A - Upgrade to curl and libcurl 7.36.0

 B - Apply the patch and rebuild libcurl

 C - Rebuild libcurl to use another TLS backend

TIMELINE
---------

It was discovered by the curl project during late February 2014.

libcurl 7.36.0 was released on March 26th 2014, coordinated with the
publication of this advisory.

CREDITS
-------

- Reported-by: Roland Moriz
- Patched-by: David Ryskalczyk
- Help-by: Nick Zitzmann

This was indirectly reported by numerous people and it was also clarified by
*Adam Langley* that it wasn't the problem Apple themselves fixed. *Roland
Moriz* is credited [in Apple's security
note](https://support.apple.com/en-us/HT202932).

Nick Zitzmann helped coordinate the bug fix.

Apple claims to have fixed this problem in an update of their own. That was
done independently from and without informing the curl project.

Thanks a lot!
