# bad spiders
SetEnvIfNoCase User-agent QQGameHall blocked=1

deny from env=blocked

ErrorDocument 404 /404.html
RedirectPermanent /devel.html https://curl.se/dev/
RedirectPermanent /auto/ https://curl.se/dev/
RedirectPermanent /docs/internals.html https://curl.se/dev/internals.html
RedirectPermanent /docs/contribute.html https://curl.se/dev/contribute.html
RedirectPermanent /docs/runtests.html https://curl.se/dev/runtests.html
RedirectPermanent /docs/testcurl.html https://curl.se/dev/testcurl.html
RedirectPermanent /source.html https://curl.se/dev/source.html
RedirectPermanent /bugreport.html https://curl.se/docs/bugs.html
RedirectPermanent /cvs.cgi https://curl.se/dev/source.html
RedirectPermanent /cvs.html https://curl.se/dev/source.html
RedirectPermanent /dev/readme-http2.html https://curl.se/docs/http2.html
RedirectPermanent /mirrors.html https://curl.se/mirror/
RedirectPermanent /libcurl/c/libcurl-thread.html https://curl.se/libcurl/c/threadsafe.html
RedirectPermanent /libcurl/c/curl-config.html https://curl.se/libcurl/using/curl-config.html
RedirectMatch "^/.git" https://curl.se/dev/source.html
RedirectPermanent /dev/security.html https://curl.se/dev/secprocess.html
RedirectPermanent /dev/FILEFORMAT.md https://github.com/curl/curl/blob/master/tests/FILEFORMAT.md
# old advisory pages
RedirectPermanent /docs/adv_2018-70a2.html https://curl.se/docs/CVE-2018-0500.html
RedirectPermanent /docs/adv_2018-82c2.html https://curl.se/docs/CVE-2018-1000300.html
RedirectPermanent /docs/adv_2018-b138.html https://curl.se/docs/CVE-2018-1000301.html
RedirectPermanent /docs/adv_2018-b047.html https://curl.se/docs/CVE-2018-1000122.html
RedirectPermanent /docs/adv_2018-97a2.html https://curl.se/docs/CVE-2018-1000121.html
RedirectPermanent /docs/adv_2018-9cd6.html https://curl.se/docs/CVE-2018-1000120.html
RedirectPermanent /docs/adv_2018-b3bf.html https://curl.se/docs/CVE-2018-1000007.html
RedirectPermanent /docs/adv_2018-824a.html https://curl.se/docs/CVE-2018-1000005.html
RedirectPermanent /docs/adv_2017-af0a.html https://curl.se/docs/CVE-2017-8818.html
RedirectPermanent /docs/adv_2017-ae72.html https://curl.se/docs/CVE-2017-8817.html
RedirectPermanent /docs/adv_2017-12e7.html https://curl.se/docs/CVE-2017-8816.html
RedirectPermanent /docs/adv_20171023.html https://curl.se/docs/CVE-2017-1000257.html
RedirectPermanent /docs/adv_20171004.html https://curl.se/docs/CVE-2017-1000254.html
RedirectPermanent /docs/adv_20170809A.html https://curl.se/docs/CVE-2017-1000101.html
RedirectPermanent /docs/adv_20170809B.html https://curl.se/docs/CVE-2017-1000100.html
RedirectPermanent /docs/adv_20170809C.html https://curl.se/docs/CVE-2017-1000099.html
RedirectPermanent /docs/adv_20170614.html https://curl.se/docs/CVE-2017-9502.html
RedirectPermanent /docs/adv_20170419.html https://curl.se/docs/CVE-2017-7468.html
RedirectPermanent /docs/adv_20170403.html https://curl.se/docs/CVE-2017-7407.html
RedirectPermanent /docs/adv_20170222.html https://curl.se/docs/CVE-2017-2629.html
RedirectPermanent /docs/adv_20161223.html https://curl.se/docs/CVE-2016-9594.html
RedirectPermanent /docs/adv_20161221A.html https://curl.se/docs/CVE-2016-9586.html
RedirectPermanent /docs/adv_20161221B.html https://curl.se/docs/CVE-2016-9952.html
RedirectPermanent /docs/adv_20161221C.html https://curl.se/docs/CVE-2016-9953.html
RedirectPermanent /docs/adv_20161102A.html https://curl.se/docs/CVE-2016-8615.html
RedirectPermanent /docs/adv_20161102B.html https://curl.se/docs/CVE-2016-8616.html
RedirectPermanent /docs/adv_20161102C.html https://curl.se/docs/CVE-2016-8617.html
RedirectPermanent /docs/adv_20161102D.html https://curl.se/docs/CVE-2016-8618.html
RedirectPermanent /docs/adv_20161102E.html https://curl.se/docs/CVE-2016-8619.html
RedirectPermanent /docs/adv_20161102F.html https://curl.se/docs/CVE-2016-8620.html
RedirectPermanent /docs/adv_20161102G.html https://curl.se/docs/CVE-2016-8621.html
RedirectPermanent /docs/adv_20161102H.html https://curl.se/docs/CVE-2016-8622.html
RedirectPermanent /docs/adv_20161102I.html https://curl.se/docs/CVE-2016-8623.html
RedirectPermanent /docs/adv_20161102J.html https://curl.se/docs/CVE-2016-8624.html
RedirectPermanent /docs/adv_20161102K.html https://curl.se/docs/CVE-2016-8625.html
RedirectPermanent /docs/adv_20160914.html https://curl.se/docs/CVE-2016-7167.html
RedirectPermanent /docs/adv_20160907.html https://curl.se/docs/CVE-2016-7141.html
RedirectPermanent /docs/adv_20160803A.html https://curl.se/docs/CVE-2016-5419.html
RedirectPermanent /docs/adv_20160803B.html https://curl.se/docs/CVE-2016-5420.html
RedirectPermanent /docs/adv_20160803C.html https://curl.se/docs/CVE-2016-5421.html
RedirectPermanent /docs/adv_20160530.html https://curl.se/docs/CVE-2016-4802.html
RedirectPermanent /docs/adv_20160518.html https://curl.se/docs/CVE-2016-3739.html
RedirectPermanent /docs/adv_20160127B.html https://curl.se/docs/CVE-2016-0754.html
RedirectPermanent /docs/adv_20160127A.html https://curl.se/docs/CVE-2016-0755.html
RedirectPermanent /docs/adv_20150617B.html https://curl.se/docs/CVE-2015-3237.html
RedirectPermanent /docs/adv_20150617A.html https://curl.se/docs/CVE-2015-3236.html
RedirectPermanent /docs/adv_20150429.html https://curl.se/docs/CVE-2015-3153.html
RedirectPermanent /docs/adv_20150422D.html https://curl.se/docs/CVE-2015-3144.html
RedirectPermanent /docs/adv_20150422C.html https://curl.se/docs/CVE-2015-3145.html
RedirectPermanent /docs/adv_20150422B.html https://curl.se/docs/CVE-2015-3148.html
RedirectPermanent /docs/adv_20150422A.html https://curl.se/docs/CVE-2015-3143.html
RedirectPermanent /docs/adv_20150108A.html https://curl.se/docs/CVE-2014-8151.html
RedirectPermanent /docs/adv_20150108B.html https://curl.se/docs/CVE-2014-8150.html
RedirectPermanent /docs/adv_20141105.html https://curl.se/docs/CVE-2014-3707.html
RedirectPermanent /docs/adv_20140910B.html https://curl.se/docs/CVE-2014-3620.html
RedirectPermanent /docs/adv_20140910A.html https://curl.se/docs/CVE-2014-3613.html
RedirectPermanent /docs/adv_20140326D.html https://curl.se/docs/CVE-2014-2522.html
RedirectPermanent /docs/adv_20140326C.html https://curl.se/docs/CVE-2014-1263.html
RedirectPermanent /docs/adv_20140326B.html https://curl.se/docs/CVE-2014-0139.html
RedirectPermanent /docs/adv_20140326A.html https://curl.se/docs/CVE-2014-0138.html
RedirectPermanent /docs/adv_20140129.html https://curl.se/docs/CVE-2014-0015.html
RedirectPermanent /docs/adv_20131217.html https://curl.se/docs/CVE-2013-6422.html
RedirectPermanent /docs/adv_20131115.html https://curl.se/docs/CVE-2013-4545.html
RedirectPermanent /docs/adv_20130622.html https://curl.se/docs/CVE-2013-2174.html
RedirectPermanent /docs/adv_20130412.html https://curl.se/docs/CVE-2013-1944.html
RedirectPermanent /docs/adv_20130206.html https://curl.se/docs/CVE-2013-0249.html
RedirectPermanent /docs/adv_20120124B.html https://curl.se/docs/CVE-2011-3389.html
RedirectPermanent /docs/adv_20120124.html https://curl.se/docs/CVE-2012-0036.html
RedirectPermanent /docs/adv_20110623.html https://curl.se/docs/CVE-2011-2192.html
RedirectPermanent /docs/adv_20101013.html https://curl.se/docs/CVE-2010-3842.html
RedirectPermanent /docs/adv_20100209.html https://curl.se/docs/CVE-2010-0734.html
RedirectPermanent /docs/adv_20090812.html https://curl.se/docs/CVE-2009-2417.html
RedirectPermanent /docs/adv_20090303.html https://curl.se/docs/CVE-2009-0037.html
RedirectPermanent /docs/adv_20070710.html https://curl.se/docs/CVE-2007-3564.html
RedirectPermanent /docs/adv_20060320.html https://curl.se/docs/CVE-2006-1061.html
RedirectPermanent /docs/adv_20051207.html https://curl.se/docs/CVE-2005-4077.html
RedirectPermanent /docs/adv_20051013.html https://curl.se/docs/CVE-2005-3185.html
RedirectPermanent /docs/adv_20050221A.html https://curl.se/docs/CVE-2005-0490.html
RedirectPermanent /docs/adv_20050221B.html https://curl.se/docs/CVE-2005-0490.html
RedirectPermanent /docs/adv_20030803.html https://curl.se/docs/CVE-2003-1605.html
RedirectPermanent /docs/adv_20001013.html https://curl.se/docs/CVE-2000-0973.html
RedirectPermanent /help.html https://curl.se/docs/help-us.html
RedirectPermanent /legal/thename.html https://curl.se/docs/thename.html
RedirectPermanent /support https://curl.se/support.html
RedirectPermanent /docs/websockets.html https://curl.se/docs/websocket.html
# old cve locations
RedirectPermanent /CVE-2009-0037/curl-7.11.0-CVE-2009-0037.patch /cves/CVE-2009-0037/curl-7.11.0-CVE-2009-0037.patch  
RedirectPermanent /CVE-2009-0037/curl-7.15.1-CVE-2009-0037.patch /cves/CVE-2009-0037/curl-7.15.1-CVE-2009-0037.patch
RedirectPermanent /CVE-2009-0037/curl-7.15.3-CVE-2009-0037.patch /cves/CVE-2009-0037/curl-7.15.3-CVE-2009-0037.patch
RedirectPermanent /CVE-2009-0037/curl-7.16.4-CVE-2009-0037.patch /cves/CVE-2009-0037/curl-7.16.4-CVE-2009-0037.patch
RedirectPermanent /CVE-2009-0037/curl-7.17.0-CVE-2009-0037.patch /cves/CVE-2009-0037/curl-7.17.0-CVE-2009-0037.patch
RedirectPermanent /CVE-2009-0037/curl-7.18.1-CVE-2009-0037.patch /cves/CVE-2009-0037/curl-7.18.1-CVE-2009-0037.patch
RedirectPermanent /CVE-2009-0037/curl-7.18.2-CVE-2009-0037.patch /cves/CVE-2009-0037/curl-7.18.2-CVE-2009-0037.patch
RedirectPermanent /CVE-2009-0037/curl-7.19.0-CVE-2009-0037.patch /cves/CVE-2009-0037/curl-7.19.0-CVE-2009-0037.patch
RedirectPermanent /CVE-2009-0037/curl-CVSHEAD-CVE-2009-0037.patch /cves/CVE-2009-0037/curl-CVSHEAD-CVE-2009-0037.patch
RedirectPermanent /CVE-2009-2417/curl-7.10.6-CVE-2009-2417.patch /cves/CVE-2009-2417/curl-7.10.6-CVE-2009-2417.patch
RedirectPermanent /CVE-2009-2417/curl-7.11.0-CVE-2009-2417.patch /cves/CVE-2009-2417/curl-7.11.0-CVE-2009-2417.patch
RedirectPermanent /CVE-2009-2417/curl-7.12.1-CVE-2009-2417.patch /cves/CVE-2009-2417/curl-7.12.1-CVE-2009-2417.patch
RedirectPermanent /CVE-2009-2417/curl-7.15.1-CVE-2009-2417.patch /cves/CVE-2009-2417/curl-7.15.1-CVE-2009-2417.patch
RedirectPermanent /CVE-2009-2417/curl-7.15.5-CVE-2009-2417.patch /cves/CVE-2009-2417/curl-7.15.5-CVE-2009-2417.patch
RedirectPermanent /CVE-2009-2417/curl-7.16.4-CVE-2009-2417.patch /cves/CVE-2009-2417/curl-7.16.4-CVE-2009-2417.patch
RedirectPermanent /CVE-2009-2417/curl-7.18.1-CVE-2009-2417.patch /cves/CVE-2009-2417/curl-7.18.1-CVE-2009-2417.patch
RedirectPermanent /CVE-2009-2417/curl-7.19.0-CVE-2009-2417.patch /cves/CVE-2009-2417/curl-7.19.0-CVE-2009-2417.patch
RedirectPermanent /CVE-2009-2417/curl-7.19.5-CVE-2009-2417.patch /cves/CVE-2009-2417/curl-7.19.5-CVE-2009-2417.patch
RedirectPermanent /CVE-2014-0015-7-27.patch /cves/CVE-2014-0015-7-27.patch
RedirectPermanent /CVE-2014-3613.patch /cves/CVE-2014-3613.patch
RedirectPermanent /CVE-2014-3620.patch /cves/CVE-2014-3620.patch
RedirectPermanent /CVE-2014-3707.patch /cves/CVE-2014-3707.patch
RedirectPermanent /CVE-2014-8150.patch /cves/CVE-2014-8150.patch
RedirectPermanent /CVE-2014-8151.patch /cves/CVE-2014-8151.patch
RedirectPermanent /CVE-2015-3143.patch /cves/CVE-2015-3143.patch
RedirectPermanent /CVE-2015-3144.patch /cves/CVE-2015-3144.patch
RedirectPermanent /CVE-2015-3145.patch /cves/CVE-2015-3145.patch
RedirectPermanent /CVE-2015-3148.patch /cves/CVE-2015-3148.patch
RedirectPermanent /CVE-2015-3153.patch /cves/CVE-2015-3153.patch
RedirectPermanent /CVE-2015-3236.patch /cves/CVE-2015-3236.patch
RedirectPermanent /CVE-2015-3237.patch /cves/CVE-2015-3237.patch
RedirectPermanent /CVE-2016-0754/CVE-2016-0754_v3_curl-7.24.0_to_7.39.0.patch /cves/CVE-2016-0754/CVE-2016-0754_v3_curl-7.24.0_to_7.39.0.patch
RedirectPermanent /CVE-2016-0754/CVE-2016-0754_v3_curl-7.40.0_to_7.46.0.patch /cves/CVE-2016-0754/CVE-2016-0754_v3_curl-7.40.0_to_7.46.0.patch
RedirectPermanent /CVE-2016-0754/CVE-2016-0754_v3_curl-7.47.0.patch /cves/CVE-2016-0754/CVE-2016-0754_v3_curl-7.47.0.patch
RedirectPermanent /CVE-2016-0755.patch /cves/CVE-2016-0755.patch
RedirectPermanent /CVE-2016-3739.patch /cves/CVE-2016-3739.patch
RedirectPermanent /CVE-2016-4802.patch /cves/CVE-2016-4802.patch
RedirectPermanent /CVE-2016-5419.patch /cves/CVE-2016-5419.patch
RedirectPermanent /CVE-2016-5420.patch /cves/CVE-2016-5420.patch
RedirectPermanent /CVE-2016-5421.patch /cves/CVE-2016-5421.patch
RedirectPermanent /CVE-2016-7141.patch /cves/CVE-2016-7141.patch
RedirectPermanent /CVE-2016-7167.patch /cves/CVE-2016-7167.patch
RedirectPermanent /CVE-2016-8615.patch /cves/CVE-2016-8615.patch
RedirectPermanent /CVE-2016-8616.patch /cves/CVE-2016-8616.patch
RedirectPermanent /CVE-2016-8617.patch /cves/CVE-2016-8617.patch
RedirectPermanent /CVE-2016-8618.patch /cves/CVE-2016-8618.patch
RedirectPermanent /CVE-2016-8619.patch /cves/CVE-2016-8619.patch
RedirectPermanent /CVE-2016-8620.patch /cves/CVE-2016-8620.patch
RedirectPermanent /CVE-2016-8621.patch /cves/CVE-2016-8621.patch
RedirectPermanent /CVE-2016-8622.patch /cves/CVE-2016-8622.patch
RedirectPermanent /CVE-2016-8623.patch /cves/CVE-2016-8623.patch
RedirectPermanent /CVE-2016-8624.patch /cves/CVE-2016-8624.patch
RedirectPermanent /CVE-2016-8625.patch /cves/CVE-2016-8625.patch
RedirectPermanent /CVE-2016-9586.patch /cves/CVE-2016-9586.patch
RedirectPermanent /CVE-2016-9594.patch /cves/CVE-2016-9594.patch
RedirectPermanent /CVE-2016-9952.patch /cves/CVE-2016-9952.patch
RedirectPermanent /CVE-2017-1000099.patch /cves/CVE-2017-1000099.patch
RedirectPermanent /CVE-2017-1000100.patch /cves/CVE-2017-1000100.patch
RedirectPermanent /CVE-2017-1000101.patch /cves/CVE-2017-1000101.patch
RedirectPermanent /CVE-2017-1000254.patch /cves/CVE-2017-1000254.patch
RedirectPermanent /CVE-2017-1000257.patch /cves/CVE-2017-1000257.patch
RedirectPermanent /CVE-2017-2629.patch /cves/CVE-2017-2629.patch
RedirectPermanent /CVE-2017-7407.patch /cves/CVE-2017-7407.patch
RedirectPermanent /CVE-2017-7468.patch /cves/CVE-2017-7468.patch
RedirectPermanent /CVE-2017-8816.patch /cves/CVE-2017-8816.patch
RedirectPermanent /CVE-2017-8817.patch /cves/CVE-2017-8817.patch
RedirectPermanent /CVE-2017-8818.patch /cves/CVE-2017-8818.patch
RedirectPermanent /CVE-2017-9502.patch /cves/CVE-2017-9502.patch
RedirectPermanent /CVE-2018-1000120.patch /cves/CVE-2018-1000120.patch
RedirectPermanent /CVE-2018-1000121.patch /cves/CVE-2018-1000121.patch
RedirectPermanent /CVE-2018-1000122.patch /cves/CVE-2018-1000122.patch
RedirectPermanent /CVE-2018-1000300.patch /cves/CVE-2018-1000300.patch
RedirectPermanent /CVE-2018-1000301.patch /cves/CVE-2018-1000301.patch

RemoveHandler .php
RemoveHandler .pl
#AddType text/plain .pl
AddType text/plain .php
AddType application/octet-stream .rpm
AddType application/x-bzip2 .bz2
AddType application/x-tar .tar
AddType application/x-pem-file .pem

Header set X-Content-Type-Options: "nosniff"
Header set Content-Security-Policy: "default-src 'self' curl.haxx.se www.curl.se curl.se www.fastly-insights.com fastly-insights.com; style-src 'unsafe-inline' 'self' curl.haxx.se www.curl.se curl.se"

# Google Custom Search requires unsafe-eval & unsafe-inline in the CSP which
# knocks a giant hole in the protection a CSP provides. Therefore, only use
# that on the pages where custom search is used to mitigate it somewhat. The
# search page that shows up on the 404 error page won't be matched by this,
# however. The following link is supposed to be updated when Google fixes this
# CSP issue and this hack can be removed:
# https://support.google.com/programmable-search/thread/60663049?hl=en
# The hash is for the inline script in sitesearch.t
<FilesMatch "^search\.html$|^list\.cgi$">
Header set Content-Security-Policy: "default-src 'self' curl.haxx.se www.curl.se curl.se www.fastly-insights.com fastly-insights.com cse.google.com www.google.com www.googleapis.com clients1.google.com; style-src 'unsafe-inline' 'self' curl.haxx.se www.curl.se curl.se www.google.com; script-src 'unsafe-eval' 'self' curl.se www.fastly-insights.com fastly-insights.com cse.google.com www.google.com clients1.google.com 'sha256-n9QfETfN26toA8vPrDtfLIC9jm4B8HE2KsS/pOkgPJ4=';"
</FilesMatch>
Header always append X-Frame-Options SAMEORIGIN

<ifmodule mod_expires.c>
ExpiresActive On
ExpiresDefault "access plus 1 seconds"
ExpiresByType text/html "access plus 1 minute"
ExpiresByType image/gif "access plus 6 months"
ExpiresByType image/jpeg "access plus 6 months"
ExpiresByType image/png "access plus 6 months"
ExpiresByType image/svg+xml "access plus 6 months"
ExpiresByType image/vnd.microsoft.icon "access plus 6 months"
ExpiresByType text/css "access plus 7 days"
ExpiresByType text/javascript "access plus 7 days"
ExpiresByType application/javascript "access plus 7 days"
ExpiresByType application/xml "access plus 7 days"
ExpiresByType text/xml "access plus 7 days"
ExpiresByType application/x-gzip "access plus 1 year"
ExpiresByType application/x-bzip2 "access plus 1 year"
ExpiresByType application/zip "access plus 1 year"
ExpiresByType application/x-tar "access plus 1 year"
ExpiresByType application/x-pem-file "access plus 30 minutes"
</ifmodule>

<IfModule mod_rewrite.c>
RewriteEngine On

RewriteCond expr "! %{HTTP_HOST} -strmatch 'curl.se'"
RewriteCond expr "! %{HTTP_HOST} -strmatch 'curl.local'"
RewriteRule (.*) https://curl.se%{REQUEST_URI} [R=301,L]

</IfModule>
